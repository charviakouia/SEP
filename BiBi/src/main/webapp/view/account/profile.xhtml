<?xml version="1.0" encoding="utf-8"?>

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:bibi="http://xmlns.jcp.org/jsf/composite/bibi"
	template="/view/templates/template.xhtml">
	
	<ui:param name="page" value="profile" />

	<ui:define name="content">

		<f:metadata>
			<f:viewParam name="id" value="#{profile.user.id}" required="true"/>
			<f:viewAction action="#{profile.onload}" /><br/>
		</f:metadata>

		<h:form id="form_profile">

			<h:outputLabel value="#{msg.userFirstName}"/>
			<h:outputText value="&#160;" />
			<h:inputText id="firstname" value="#{profile.user.firstName}" required="true"/>
			<br/>

			<h:outputLabel value="#{msg.userLastName}"/>
			<h:outputText value="&#160;" />
			<h:inputText id="lastname" value="#{profile.user.lastName}" required="true"/>
			<br/>

			<h:outputLabel value="#{msg.userPassword}"/>
			<h:outputText value="&#160;" />
			<h:inputSecret id="password" value="#{profile.password}" required="true"
						   validator="passwordValidator"/>
			<br/>

			<h:outputLabel value="#{msg.userConfirmedPassword}"/>
			<h:outputText value="&#160;" />
			<h:inputSecret id="confirmedPassword" value="#{profile.confirmedPassword}" required="true"
						   validator="confirmPasswordValidator"/>
			<br/>

			<h:outputLabel value="#{msg.userEmailAddress}"/>
			<h:outputText value="&#160;" />
			<h:inputText id="email" value="#{profile.user.emailAddress}" required="true"
						 validator="emailValidator"/>
			<br/>

			<h:outputLabel value="#{msg.userZipCode}"/>
			<h:outputText value="&#160;" />
			<h:inputText id="zipCode" value="#{profile.user.zipCode}"/>
			<br/>

			<h:outputLabel value="#{msg.userCity}"/>
			<h:outputText value="&#160;" />
			<h:inputText id="city" value="#{profile.user.city}"/>
			<br/>

			<h:outputLabel value="#{msg.userStreet}"/>
			<h:outputText value="&#160;" />
			<h:inputText id="street" value="#{profile.user.street}"/>
			<br/>

			<h:outputLabel value="#{msg.userStreetNumber}"/>
			<h:outputText value="&#160;" />
			<h:inputText id="streetNumber" value="#{profile.user.streetNumber}"/>
			<br/>

			<h:outputLabel value="#{msg.userRole}" rendered="#{userSession.user.role == 'ADMIN'}"/>
			<h:outputText value="&#160;" />
			<h:selectOneMenu id="userRole" value="#{profile.user.role}"
							 rendered="#{userSession.user.role == 'ADMIN'
							 and profile.user.id != userSession.user.id}">

				<f:selectItems value="#{profile.allUserRoles}"
							   var="role" itemValue="#{role}"
							   itemLabel="#{msg[role.toString()]}"/>
			</h:selectOneMenu>
			<br/>

			<h:outputLabel value="#{msg.userStatus}" rendered="#{userSession.user.role == 'ADMIN'}"/>
			<h:outputText value="&#160;" />
			<h:selectOneMenu id="accountStatus" value="#{profile.user.userVerificationStatus}"
							 rendered="#{userSession.user.role == 'ADMIN'}">

				<f:selectItems value="#{profile.allUserStatus}"
							   var="status" itemValue="#{status}"
							   itemLabel="#{msg[status.toString()]}"/>
			</h:selectOneMenu>
			<br/>

			<h:outputLabel value="#{msg.userReturnPeriod}" rendered="#{userSession.user.role == 'ADMIN'}"/>
			<h:outputText value="&#160;" />
			<h:inputText id="returnPeriod" value="#{profile.user.lendingPeriod}"
						 rendered="#{userSession.user.role == 'ADMIN'}"/>
			<br/>
			<br/>

			<h:commandButton id="button_save"
							 value="#{msg.saveProfile}"
							 action="#{profile.save()}"
							 styleClass="btn btn-secondary" />

		</h:form>

		<h:link value="#{msg.toMyCopiesReadyForPickup}" outcome="copies-ready-for-pickup">
			<f:param name="id" value="#{profile.user.id}"/>
		</h:link>

		<br/>

		<h:link value="#{msg.toMyBorrowedCopies}" outcome="borrowed-copies">
			<f:param name="id" value="#{profile.user.id}"/>
		</h:link>

		<h:form id="delUserForm">

			<h:commandButton id="button_del_user"
							 value="#{msg.toProfileDelete}"
							 action="#{profile.delete()}"
							 styleClass="btn btn-secondary" />
		</h:form>

	</ui:define>
	
</ui:composition>
